version: "3.9"

services:
    web:
        build: .
        ports:
            - "80:80"
        environment:
            - MYSQL_HOST=mysql
            - MYSQL_DATABASE=bluecalendar
            - MYSQL_USER=bluecalendar
            - MYSQL_PASSWORD=bluecalendar
            - SMTP_HOST=mailhog
            - SMTP_PORT=1025
            - FROM_NAME=Bluecube
            - SUBJECT_PREFIX=[BlueCalendar]
        develop:
            watch:
                - action: sync
                  path: .
                  target: /var/www/html
                  ignore:
                      - vendor/
                      - .git/
                      - node_modules/
    mysql:
        image: mysql:8
        ports:
            - "3306:3306"
        environment:
            - MYSQL_ROOT_PASSWORD=bluecalendar
            - MYSQL_DATABASE=bluecalendar
            - MYSQL_USER=bluecalendar
            - MYSQL_PASSWORD=bluecalendar
        volumes:
            - ./sql/init_bluecalendar.sql:/docker-entrypoint-initdb.d/init_bluecalendar.sql

    mailhog:
        image: mailhog/mailhog
        ports:
            - "1025:1025"
            - "8025:8025"
